<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>{% block title %}{{ SITENAME }}{% endblock %}</title>
    <link rel="stylesheet" type="text/css" href="{{ SITEURL }}/theme/css/pygments.css">
    <link rel="stylesheet" type="text/css" href="{{ SITEURL }}/theme/css/style.css">
    <script>

        document.addEventListener("DOMContentLoaded", function() {

              document.querySelectorAll(".highlighttable").forEach((highlighttable) => {

                  // Creación de wrapper para el bloque de código y botón
                  const highlightTableWrapper = document.createElement('div');
                  highlightTableWrapper.classList.add('highlighttable-wrapper'); // Add the class

                  // Crea botón para copiar código
                  const codeBlockCopyPasteButton = document.createElement("button");
                  codeBlockCopyPasteButton.innerText = "copiar";
                  codeBlockCopyPasteButton.className = "copy-btn";

                  // Inserta primero wrapper y despues highlighttable
                  highlighttable.parentNode.insertBefore(highlightTableWrapper, highlighttable);
                  highlightTableWrapper.appendChild(highlighttable);
                  highlightTableWrapper.appendChild(codeBlockCopyPasteButton)

                  codeBlockCopyPasteButton.addEventListener("click", () => {
                      // obtiene el elemento tag code
                      const codeElem = highlighttable.querySelector("code");
                      if (!codeElem) return;

                      const code = codeElem.innerText;
                      navigator.clipboard.writeText(code).then(() => {
                          codeBlockCopyPasteButton.innerText = "copiado!";
                          setTimeout(() => (codeBlockCopyPasteButton.innerText = "copiar"), 2000);
                      });
                  });
              });
        });

        document.addEventListener("DOMContentLoaded", () => {
  const searchInput = document.getElementById("search-bar");
  const resultsContainer = document.createElement("div");
  resultsContainer.className = "search-results";
  searchInput.parentNode.appendChild(resultsContainer);

  let articles = [];

  // Load JSON
  fetch("{{ SITEURL }}/search.json")
    .then(response => response.json())
    .then(data => { articles = data; });

  // Search logic
  searchInput.addEventListener("input", () => {
    const query = searchInput.value.toLowerCase().trim();
    resultsContainer.innerHTML = "";

    if (!query) return;

    const words = query.split(/\s+/);

    // ✅ At least one word must match title, summary, or tags
    const matches = articles.filter(article =>
      words.some(word =>
        (article.title && article.title.toLowerCase().includes(word)) ||
        (article.summary && article.summary.toLowerCase().includes(word)) ||
        (article.tags && article.tags.join(" ").toLowerCase().includes(word))
      )
    );

    if (matches.length === 0) {
      resultsContainer.innerHTML = "<div>No results found</div>";
    } else {
      matches.forEach(article => {
        const item = document.createElement("div");
        item.className = "search-result";
        item.innerHTML = `<a href="${article.url}">${article.title}</a>`;
        resultsContainer.appendChild(item);
      });
    }
  });
});
    </script>

</head>
<body>

    {% include 'navbar.html' %}

    <main>
        {% block content %}{% endblock %}
    </main>

    <footer>
        {% include 'footer.html' %}
    </footer>
</body>
</html>
